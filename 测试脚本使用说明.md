# 测试脚本使用说明

## 📋 脚本说明

系统提供了多个脚本，可以一次性测试和运行所有功能：

### 1. **run_test.bat** / **run_test.sh** - 仅运行测试
   - 编译项目
   - 运行测试脚本创建测试数据
   - **不启动GUI界面**

### 2. **run_all.bat** / **run_all.sh** - 完整运行（推荐）
   - 编译项目
   - 运行测试脚本创建测试数据
   - **自动启动GUI界面**

## 🚀 使用方法

### Windows系统

**方法1：使用完整运行脚本（推荐）**
```bash
run_all.bat
```

**方法2：仅创建测试数据**
```bash
run_test.bat
```

**方法3：手动运行**
```bash
# 1. 编译项目
mvn clean compile

# 2. 运行测试脚本
mvn exec:java -Dexec.mainClass="com.bigcomp.accesscontrol.test.SystemTestRunner"

# 3. 启动GUI（如果需要）
mvn exec:java -Dexec.mainClass="com.bigcomp.accesscontrol.Main"
```

### Linux/Mac系统

**方法1：使用完整运行脚本（推荐）**
```bash
chmod +x run_all.sh
./run_all.sh
```

**方法2：仅创建测试数据**
```bash
chmod +x run_test.sh
./run_test.sh
```

## 📦 测试脚本功能

`SystemTestRunner` 会自动创建以下测试数据：

### 1. 测试用户（5个）
- 员工：张三、李四
- 承包商：王五
- 实习生：赵六
- 访客：钱七

### 2. 测试资源（13个）
- 场地入口：主入口大门、停车场入口
- 建筑入口：主办公楼正门、侧门
- 办公室门：办公室1、办公室2、会议室
- 电梯和楼梯：主电梯、主楼梯
- 其他资源：打印机1、打印机2、饮料机、服务器室

### 3. 读卡器（13个）
- 为每个资源自动创建对应的读卡器

### 4. 资源组（4个）
- **公共区域**（安全级别1）：入口、大门等
- **办公区域**（安全级别2）：办公室、会议室等
- **设备资源**（安全级别2）：打印机、饮料机等
- **高安全区域**（安全级别3）：服务器室、电梯等

### 5. 配置文件（4个）
- **员工权限**：工作日 8:00-18:00，可访问公共区域、办公区域、设备资源
- **承包商权限**：工作日 9:00-17:00，可访问公共区域、办公区域
- **实习生权限**：工作日 9:00-17:00，可访问公共区域、办公区域
- **访客权限**：工作日 10:00-16:00，仅可访问公共区域

### 6. 配置文件分配
- 自动为每个用户分配对应的配置文件

## ✅ 测试完成后

运行测试脚本后，系统会：

1. ✅ 创建所有测试数据
2. ✅ 显示测试摘要
3. ✅ 如果使用 `run_all.bat/sh`，会自动启动GUI界面

## 🎯 在GUI中测试功能

启动GUI后，您可以测试：

1. **用户管理**：查看已创建的用户和徽章
2. **资源管理**：查看已创建的资源
3. **资源组管理**：查看已创建的资源组
4. **配置文件管理**：查看已创建的配置文件
5. **实时监控**：查看场地和楼层图（需要放置图片文件）
6. **事件模拟**：添加用户并开始模拟访问事件
7. **日志查看**：查看访问日志（模拟事件后会自动生成）

## 📝 注意事项

1. **首次运行**：脚本会自动创建数据库和所有必要的目录
2. **图片文件**：实时监控需要图片文件：
   - `images/site-layout.png` - 场地平面图
   - `images/office-layout.png` - 办公楼楼层图
3. **数据持久化**：所有测试数据会保存到数据库和文件中，下次运行时会保留
4. **重新运行**：如果数据库已存在，会更新现有数据（使用 INSERT OR REPLACE）

## 🔧 故障排除

### 问题：编译失败
**解决**：确保已安装Java 21和Maven

### 问题：找不到主类
**解决**：确保在项目根目录运行脚本

### 问题：数据库错误
**解决**：删除 `data/access_control.db` 文件后重新运行

### 问题：图片不显示
**解决**：将图片文件放到 `images/` 目录下

